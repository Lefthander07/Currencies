<p align="center">
  <img src="/assets/logo.png" alt="logo" title="backend интенсив fuse8"/>
</p>

# Задание к уроку 6

В данном задании вам необходимо завернуть pet-проект в Docker <br />
После выполнения задания, выполнение следующей команды должно запускать полностью рабочее решение
```shell
docker compose -p internship -f docker-compose.yml up --build -d
```

## Добавить `Dockerfile`
Необходимо добавить Dockerfile для сборки образов для `InternalApi` и `PublicApi` <br />
В Dockerfile необходимо сделать следующее
- Реализовать кэширование nuget-пакетов с использованием `dotnet-subset`
- Добавить описание через инструкции `LABEL`, `EXPOSE`, `VOLUME`

С помощью файла `.dockerignore` исключить попадание в образ компилируемых файлов (папки /bin, /obj и пр.) <br />
и файлов, которые нужны только для запуска проекта локально - файлы IDE (.vs, .idea), файлы гита (.git) и пр.

## Добавить файл для развертывания решения через `docker compose`
Добавить файл `docker-compose.yml` <br />
В файле должны быть добавлены три сервиса
- Сервис `InternalApi`
- Сервис `PublicApi`
- Сервис с базой данных `postgres`

У всех сервисов в `docker-compose.yml` должна быть настроена политика перезапуска `unless-stopped`

У сервисов `InternalApi` и `PublicApi` должны быть определены следующие параметры
- Имя контейнера
- Имя образа
- Список используемых портов
- Переменные окружения
- Контекст сборки
- Healthcheck

Для `InternalApi` через переменные окружения необходимо переопределить следующие настройки:
- Строка подключения к БД
- REST-порт, по которому доступно API
- gRPC-порт, по которому доступен gRPC-сервис
- ASPNETCORE_ENVIRONMENT

Для `PublicApi` через переменные окружения необходимо переопределить следующие настройки:
- Строка подключения к БД
- Базовый урл для доступа к gRPC-сервису `InternalApi`
- ASPNETCORE_ENVIRONMENT

Настроить зависимость сервисов
- Сервис `PublicApi` должен запускаться только после того, как сервис `InternalApi` перейдет в состояние `healthy`


## Добавить файл с переменными .env для `docker-compose.yml`
- Переменные из файла .env должны использоваться в `docker-compose.yml`
- В .env должны быть определены переменные, которые используются в нескольких сервисах (например, данные для авторизации в БД)
- В .env должны быть определены переменные, которые используются в нескольких местах в рамках одного сервиса (например, порты)
- В .env должны быть определены переменные, которые зависят от окружения, в котором запускается проект (например, значение для ASPNETCORE_ENVIRONMENT)

# Подготовить проект к финальному ревью
Это последнее задание интенсива <br />
Поэтому исправьте замечания, которые остались после прошлых ревью и подготовьте pet-проект к финальному ревью <br />

Несколько рекомендаций
- Удалите неиспользуемые файлы/методы
- Приведите код к единому стилю. Можете настроить в вашей IDE стили как вам нравится, а потом массово исправить стили во всем проекте. Например, в Rider это делается через [Code Cleanup](https://www.jetbrains.com/help/rider/Code_Cleanup__Index.html#running). Поищите аналогичную функцию для своей IDE
- Исправьте все варнинги IDE. Для этого нужно настроить, чтобы ваша IDE их отображала. Например, в Rider это делается через [Solution-wide analysis](https://www.jetbrains.com/help/rider/Code_Analysis__Solution-Wide_Analysis.html#monitor-warnings-in-solution). Поищите аналогичную функцию для своей IDE
- Добавьте описание для публичных методов сервисов, моделей, сущностей и пр.
